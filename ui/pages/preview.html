<!DOCTYPE html>
<html>
<head>
    <title>Image Preview</title>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="/assets/api-common.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #000; 
            height: 100vh; 
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        img { 
            max-width: 100vw; 
            max-height: 100vh; 
            width: auto;
            height: auto;
            object-fit: contain;
        }
    </style>
</head>
<body>
    <div x-data="previewApp()" x-init="loadImage()">
        <img :src="imageUrl" alt="Image Preview" x-show="imageUrl">
    </div>

    <script>
        function previewApp() {
            return {
                imageUrl: '',
                
                async loadImage() {
                    try {
                        const urlParams = new URLSearchParams(window.location.search);
                        const fileKey = urlParams.get('file');
                        
                        if (!fileKey) {
                            return;
                        }
                        
                        const response = await apiCall('GET', `/api/get-signed-url/${encodeURIComponent(fileKey)}`);
                        
                        if (response.data.success) {
                            this.imageUrl = response.data.data.url;
                        }
                    } catch (err) {
                        console.error('Error loading image:', err);
                    }
                }
            }
        }
    </script>
</body>
</html>
